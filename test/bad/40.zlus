(* This program must be rejected because the block automaton is *)
(* executed atomically *)
let node f(x) =
  let rec
      automaton
      | S -> do y = 1 and z = r done
      end
  and automaton
      | S -> do k = y and r = 2 done
      end in
  y,z
