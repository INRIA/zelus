let hybrid f (x, z) = y where
  rec automaton
      | S0 -> do y = 0 unless z on (x <= 3) then S0

