let node g x = y where
   rec automaton
       | A -> do y = x
              until (y <= 0) then B
       | B -> do y = 0
              until (y = 0) then A
       end
