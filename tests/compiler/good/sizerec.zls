let f5<<n>>(x) = x + 1

let g(x) = f5<<42>>(x)

let f2 x returns (o)
  let f<<n>>(x) = x + n in
  do o = f<<42>>(x+1) + f<<44>>(x+2) + f<<42>>(x+3) done

let f<<n>> x =
  let rec f<<n>>(x) =
    match size n with
    | 0 -> 0
    | 1 -> 1
    | n -> f<<n/2>>(x-1) + f<<n/2>>(x+1) in
  f<<n>>(x)

let f3 x =
  let rec f3<<n>>() = match size n with | 0 -> 0 | n -> f3<<n-1>>() + 1 in
  f3<<2>>()

let f4 =
  let rec f<<n>>(x) returns (o)
    match size n with
    | 0 -> o = false
    | 1 -> o = true
    | _ -> 
      do o = f<<n/2>>(x) || f<<n/2>>(x) done in
  f<<4>>(0)

let f6 =
  let rec or_<<n>>(x:[n]'a) returns o
    match size n with
    | 0 -> o = false
    | 1 -> o = x.(0)
    | _ -> o = or_<<n/2>>(x.(0 .. n/2 - 1)) ||
               or_<<n - n/2>>(x.(n/2 .. n - 1)) in
  or_<<4>>([| false; false; true; false |])
