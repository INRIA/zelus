let hybrid sin_cos epsilon =
  let der t = 1.0 init 0.0 in
  let s_ref = sin t and c_ref = cos t in
  assert
    (let rec der s = c init 1.0 and der c = -. s init 0.0 in
     (abs_float (s -. s_ref) <= epsilon) && (abs_float (c -. c_ref) <= epsilon))
